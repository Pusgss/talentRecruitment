<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>人才招聘</title>

	<link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,300,700|Roboto:300,400" rel="stylesheet" type="text/css">
	<!-- Animate.css -->
	<link rel="stylesheet" href="/static/css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="/static/css/icomoon.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="/static/css/bootstrap.css">

	<link rel="stylesheet" href="/static/css/style.css">

    <link rel="shortcut icon" href="/static/favicon.ico" type="image/x-icon" />
    <script src="/static/jquery-3.4.1.min.js"></script>
    <script src="/static/vue.js"></script>
    <script src="http://apps.bdimg.com/libs/jquery.cookie/1.4.1/jquery.cookie.js"></script>
    <link href="//cdn.bootcss.com/toastr.js/latest/css/toastr.min.css" rel="stylesheet">
    <script src="//cdn.bootcss.com/toastr.js/latest/js/toastr.min.js"></script>
    <script src="https://cdn.staticfile.org/vue/2.2.2/vue.min.js"></script>
    <script src="https://cdn.staticfile.org/vue-resource/1.5.1/vue-resource.min.js"></script>
    <!-- 导入 CSS 样式 -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <!-- 导入Vue -->
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
    <!-- 引入组件库 -->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
     <style>
      .demo-table-expand {
        font-size: 0;
      }
      .demo-table-expand label {
        width: 120px;
        color: #99a9bf;
      }
      .demo-table-expand .el-form-item {
        margin-right: 0;
        margin-bottom: 0;
        width: 50%;
      }
     ul li{

display: inline;
list-style-type: none;
padding: 5px 5px;}

    </style>
	</head>
    <body>
	<div class="box-wrap">
		<header role="banner" id="fh5co-header">
			<div class="container">
				<nav class="navbar navbar-default">
					<div class="row">
						<div class="col-md-3">
							<div class="fh5co-navbar-brand">
								<a class="fh5co-logo" href="index.html"><img src="/static/image/logo.png" alt="Closest Logo"></a>
							</div>
						</div>
						<div class="col-md-6">
                            <div id="nav">
                                <el-menu
                              :default-active="activeIndex2"
                              class="el-menu-demo"
                              mode="horizontal"
                              @select="handleSelect"
                              background-color="#ffffff"
                              text-color="#000000"
                              active-text-color="#6F00D2">
                                 <el-menu-item ><el-link href="/api/company_index/" icon="el-icon-s-home" type="primary">主页</el-link></el-menu-item>
              <el-menu-item index="2" ><el-link href="/api/company_show/" icon="el-icon-document">职位管理</el-link></el-menu-item>
              <el-menu-item index="3" ><el-link href="/api/resumeManage/" icon="el-icon-s-promotion">简历管理</el-link></el-menu-item>
              <el-menu-item index="4" ><el-link href="/api/getAllResume/" icon="el-icon-search">人才搜索</el-link></el-menu-item>
              <el-menu-item index="5">  <el-link href="/api/getResumeCollect/" icon="el-icon-star-on">人才库</el-link>  </el-menu-item>

                            </el-menu>
                        </div>
						</div>
						<div class="col-md-3">
                              <ul class="social">
                                    <li><strong style="text-align: center;font-size:14px">{{ request.session.user_name }}</strong></li>
                                    <li><a href="/api/company_show/"><i class="el-icon-s-custom"></i></a></li>
                                    <li><a href="/api/logout"><i class="el-icon-s-tools"></i></a></li>
                                 </ul>
						</div>
					</div>
				</nav>
		  </div>
		</header>
		<!-- END: header -->
		<section id="work">
			<div class="container">
				<div class="row">
					<div class="col-md-12">

                            <div id='app' style="width:1000px;margin:0 auto;">
                <el-card>

                                    <el-card style="background-color: yellowgreen;width:900px">
                            <div style=" float:left;">
                <span>已选择:</span>
                                 <template v-if='condition.length'>
                            <span v-for='(item,index) in condition' class='active'>

                                [[item.name]]&nbsp;|&nbsp;
                            </span>
                                     </template>
                            </div>
                                <div style="float:right;">
                                 <el-button  style=" border-color: yellowgreen;Border-radiu: 12px;height:40PX" @click="conditionSearch"  icon="el-icon-search">搜索</el-button>
                            </div>
                </el-card>
                <div style="height: 20px"></div>
                                <template v-if='category.length'>
                                    <div class='nav' v-for='(items,index) in category'>
                                        <div class='mutil-query-title' v-if='items.name' :key="items.id">[[items.name]]
                                            <span style='margin-left: 20px;' @click='allIn(index)'>全选</span>|<span @click='remove(index)'>清空</span>
                                        </div>

                                        <ul v-if='items.items.length' >
                                            <li v-for='(item,key) in items.items'>
                                                <span :class="{'active':item.active}" @click='handle(index,key)' :key='item.id' style="font-size: 14px">[[item.name]]</span>

                                            </li>
                                        </ul>
                                        <el-divider></el-divider>
                                    </div>
                                </template>
                           </el-card>
                            </div>
                        <div style="height:40px">

                        </div>
                          <div id="resume_list">

          <el-select v-model="category" >
                            <el-option label="期望职位" value="desired_position"></el-option>
                            <el-option label="性别" value="sex"></el-option>
                            <el-option label="学历" value="education_background"></el-option>
            '           </el-select>

                <el-input v-model="keyword" type="text"  placeholder="关键字" style="width:300px" class="form-control" auto-complete="off" ></el-input>

                 <el-button  @click="resumeSearch" type="primary" icon="el-icon-search">搜索</el-button>

                <el-button @click="toggleSelection()">取消选择</el-button>

                 <el-button  @click="toInterview" type="primary" :disabled="disable==0?true:false">面试邀请</el-button>

                     <el-button  @click="resumeCollect" type="primary" :disabled="disable==0?true:false">收藏</el-button>

{#          <el-dialog :visible.sync="centerDialogVisible">#}
{#             <h3>发送面试邀请</h3>#}
{#                        <el-form :model="InterviewForm" :rules="rules" ref="InterviewForm" label-width="80px" >#}
{#                    <el-form-item label="面试时间" prop="time">#}
{#                <el-date-picker   v-model="InterviewForm.time"  :picker-options="pickerOptions" type="datetime" value-format="yyyy-MM-dd HH:mm:ss"  placeholder="选择日期时间">#}
{#    </el-date-picker>#}
{#                    </el-form-item>#}
{#                    <el-form-item label="标题" prop="title">#}
{#                        <el-input type="text" name="title" placeholder="请输入标题" class="form-control" auto-complete="off" v-model="InterviewForm.title"></el-input>#}
{#                    </el-form-item>#}
{#                    <el-form-item label="注意事项" prop="content">#}
{#                        <el-input type="textarea" name="content" placeholder="注意事项" class="form-control" auto-complete="off" v-model="InterviewForm.content"></el-input>#}
{#                    </el-form-item>#}
{#                </el-form>#}
{##}
{#                        <div>#}
{#                            <el-button @click="closeDialog()">取消</el-button>#}
{#                            <el-button type="primary" @click="resumeInterview('InterviewForm')">确定</el-button>#}
{#                        </div>#}
{#		            </el-dialog>#}
                                <el-dialog  width="70%" :visible.sync="centerDialogVisible" title="发送面试邀请"  >
{#             <div style="float:left;width: 450px;height:480px; background-color: #3a8ee6">#}

                        <el-form :model="InterviewForm" :rules="rules" ref="InterviewForm" label-width="80px" style="float:left;width: 450px;height:500px; background-color: #3a8ee6">
                    <el-form-item label="面试时间" prop="time">
                <el-date-picker   v-model="InterviewForm.time"  :picker-options="pickerOptions" type="datetime" value-format="yyyy-MM-dd HH:mm:ss"  placeholder="选择日期时间">
                </el-date-picker>
                    </el-form-item>
                    <el-form-item label="标题" prop="title">
                        <el-input type="text" name="title" placeholder="请输入标题" class="form-control" auto-complete="off" v-model="InterviewForm.title"></el-input>
                    </el-form-item>
                    <el-form-item label="注意事项" prop="content">
                        <el-input type="textarea"  :rows="2" name="content" placeholder="注意事项" class="form-control" auto-complete="off" v-model="InterviewForm.content"></el-input>
                    </el-form-item>

  <el-form-item >

                            <el-button @click="closeDialog()">取消</el-button>
                            <el-button type="primary" @click="resumeInterview('InterviewForm')">确定</el-button>

                   </el-form-item>
                        </el-form>
{#                 </div>#}
{#             <div style="float:left;width: 100px;height:480px;background-color:#fb1e1e ">#}
{##}
{#             </div>#}
{#             <div style="float:left;width: 520px;height:500px;">#}
  <el-table
    :data="tableData" style="float:left;width: 520px;height:500px;">
    <el-table-column
      prop="date"
      label="时间段"
      width="120">
    </el-table-column>

      <el-table-column label="日期">
          <el-table-column
          prop="name"
           :label = week[0]
          width="80">
        </el-table-column>
        <el-table-column
          prop="province"
          :label = week[1]
          width="80">
        </el-table-column>
        <el-table-column
          prop="city"
         :label = week[2]
          width="80">
        </el-table-column>

        <el-table-column
          prop="address"
          :label = week[3]
          width="80">
        </el-table-column>
          <el-table-column
          prop="zip"
         :label = week[4]
          width="80">
        </el-table-column>

      </el-table-column>

  </el-table>
{##}
{#             </div>#}

		            </el-dialog>

        <template>
            <el-table
                ref="multipleTable"
                :data="resume_list"
                tooltip-effect="dark"
                style="width: 100%"
                @selection-change="handleSelectionChange">
                <el-table-column
                  type="selection"
                  width="55">
                </el-table-column>
                <el-table-column
                  prop="user_name"
                  label="姓名"
                  width="100">
                </el-table-column>
                </el-table-column>
                <el-table-column
                  prop="user_email"
                  label="邮箱"
                  width="200"
                  show-overflow-tooltip>
                </el-table-column>
                  <el-table-column
                  prop="sex"
                  label="性别"
                  width="80"
                  show-overflow-tooltip>
                </el-table-column>
                   <el-table-column
                  prop="education_background"
                  label="学历"
                  width="100">
                </el-table-column>
                  <el-table-column
                  prop="age"
                  label="年龄"
                  width="80"
                  show-overflow-tooltip>
                </el-table-column>
                 <el-table-column
                  prop="city"
                  label="现居住地"
                  width="140">
                 </el-table-column>
                 <el-table-column
                        prop="resume_name"
                  label="简历"
                  width="120">
                    <template slot-scope="scope">
{#                        <el-link href="'/api/resume_show?id='id" type="info">[[scope.row.resume_name]]</el-link>#}
                        <a :href="'/api/resumeDetail?id='+scope.row.id" target="_blank">[[scope.row.resume_name]]</a>
                    </template>
                </el-table-column>

                <el-table-column
                  prop="desired_position"
                  label="期望职位"
                  width="120">
                </el-table-column>
                 <el-table-column
                  prop="expected_salary"
                  label="期望薪资"
                  width="120">
                </el-table-column>
                <el-table-column
                  prop="expected_work_city"
                  label="期望工作地点"
                  width="140">
                </el-table-column>

            </el-table>
            <el-pagination v-show="total>0"
                          @size-change="handleSizeChange"
                          @current-change="handleCurrentChange"
                          :current-page="currentPage"
                          :page-size="pageSize"
                          layout="total, sizes, prev, pager, next, jumper"
                          :total="total">
                    </el-pagination>
             <div style="margin-top: 20px">
{#    <el-button @click="toggleSelection([tableData[1], tableData[2]])">切换第二、第三行的选中状态</el-button>#}
            </div>
        </template>
    </div>

					</div>
				</div>
			</div>
		</section>
	</div>
        <script>
        var resumeVue=new Vue({
            el:'#resume_list',
            data() {
            return {
                category:'education_background',
                keyword:'',
                resume_list:[],
                multipleSelection: [],
                id_list:[],
                disable:0,
                centerDialogVisible: false,
                InterviewForm:{
                    time:'',
                    title:'',
                    content:'',
                },
                rules:
                {
                    time:[{required: true, message: '请填写面试时间', trigger: 'blur'},],
                    title:[{required: true, message: '请填写邮件主题', trigger: 'blur'},],
                    content:[{required: true, message: '请填写面试注意事项', trigger: 'blur'},],
                },
                pickerOptions: {
                          disabledDate(time) {
                              return time.getTime() < Date.now() - 8.64e7;
                          }
                  },
                total:0,
                  pageSize:20,
                  currentPage: 1,
                flag:'getList',
                 tableData: [],
          week:'yu',
                }

            },
            created: function () {

                     this.getList(this.currentPage,this.pageSize);

                     if (this.multipleSelection.length==0){
                         this.disable=0
                     }
            },
            methods: {
                getInterview(){
                $.ajax({
                    url:'/api/interviewByWeek/',
                    type:'POST',
                    headers: {"X-CSRFToken": $.cookie('csrftoken')},
                    success:function (data) {
                        console.log(data.week_list);

                        resumeVue.tableData = [];
                        for (let i = 0; i < data.interview_list_list.length; i++) {

                                resumeVue.tableData.push({
                                    date:'9:00~10:00',
                                    name:data.interview_list_list[i][0],
                                province:data.interview_list_list[i][1],
                                city:data.interview_list_list[i][2],
                                address:data.interview_list_list[i][3],
                                zip:data.interview_list_list[i][4]});
                                console.log(resumeVue.tableData[i]);

                        };
                        resumeVue.tableData[1].date='10:00~11:00';
                         resumeVue.tableData[2].date='11:00~12:00';
                        resumeVue.tableData[3].date='12:00~13:00';
                        resumeVue.tableData[4].date='13:00~14:00';
                        resumeVue.tableData[5].date='14:00~15:00';
                        resumeVue.tableData[6].date='15:00~16:00';
                        resumeVue.tableData[7].date='16:00~17:00';

                        resumeVue.week=data.week_list;

                    }
                })

            },
                toggleSelection(rows) {
                    if (rows) {
                      rows.forEach(row => {
                        this.$refs.multipleTable.toggleRowSelection(row);
                      });
                    }
                    else {
                      this.$refs.multipleTable.clearSelection();
                    }
                },
                handleSelectionChange(val) {
                    this.multipleSelection = val;
                    console.log(this.multipleSelection);
                    if(this.multipleSelection.length==0)
                    {
                        this.disable=0;
                    }
                    else
                    {
                        this.disable=1;
                    }
                },
                   handleSizeChange(size) {
                    this.pageSize = size;
                    if(this.flag=='getList'){
                        this.getList(this.currentPage,this.pageSize);
                    }
                    else if(this.flag=='resumeSearch'){
                        this.resumeSearch();
                    }
                    else{
                        app.conditionSearch()
                    }
                },
                handleCurrentChange(currentpage) {
                    this.currentPage = currentPage;
                     if(this.flag=='getList'){
                        this.getList(this.currentPage,this.pageSize);
                    }
                    else if(this.flag=='resumeSearch'){
                        this.resumeSearch();
                    }
                    else{
                        app.conditionSearch()
                    }
                },
                getList(currentPage,pageSize)
                        {
                             $.ajax({
                                  url:"/api/getAllResume/",
                                  type:"post",
                                  data: {'page':currentPage,'pageSize':pageSize },
                                  headers:{"X-CSRFToken":$.cookie('csrftoken')},
                                  success:function (data) {
                                      var user_list=JSON.parse(data.user_list);
                                      var resume_list=JSON.parse(data.resume_list);
                                      var hunter_list=JSON.parse(data.hunter_list);
                                      resumeVue.total=data.total;
                                      resumeVue.resume_list=[];
                                      for(let i = 0; i < resume_list.length; i++) {
                                          resumeVue.resume_list.push({
                                              id:resume_list[i].pk,
                                              user_name:hunter_list[i].fields.user_name,
                                              user_email:user_list[i].fields.user_email,
                                              user_phone:user_list[i].fields.user_phone,
                                              {#sex:hunter_list[i].fields.sex,#}
                                              age:resumeVue.getAge(hunter_list[i].fields.birthday),
                                              city:hunter_list[i].fields.city,
                                              Correspondence_address:hunter_list[i].fields.Correspondence_address,
                                              registered_permanent_residence:hunter_list[i].fields.registered_permanent_residence,
                                              education_background:hunter_list[i].fields.education_background,
                                              qq:hunter_list[i].fields.qq,
                                              resume_name:resume_list[i].fields.resume_name,
                                              desired_position:resume_list[i].fields.desired_position,
                                              expected_salary:resume_list[i].fields.expected_salary,
                                              expected_work_city:resume_list[i].fields.expected_work_city,
                                          });
                                          if(hunter_list[i].fields.sex=='0'){
                                                resumeVue.resume_list[i].sex="男";

                                            }
                                            else if(hunter_list[i].fields.sex=='1'){
                                                resumeVue.resume_list[i].sex="女";

                                }

                                      };
                                  }
                             })
                        },
                  toInterview(){this.centerDialogVisible = true;
                  this.getInterview();},
            resumeInterview(formName){
                this.$refs[formName].validate((valid) => {
                    if (valid) {
                      if (this.multipleSelection.length > 1) {
                          this.$message.warning("请您一次只给一位求职者发送面试邀请");
                      } else {
                          this.id = this.multipleSelection[0].id;

                      }
                        $.ajax({
                  url: "/api/resumeInterview/",
                  type: "post",
                  headers: {"X-CSRFToken": $.cookie('csrftoken')},
                  data: {
                      'id': resumeVue.id,
                      'time': resumeVue.InterviewForm.time,
                      'title': resumeVue.InterviewForm.title,
                      'content': resumeVue.InterviewForm.content,
                  },
                  dataType:'JSON',
                  success: function (data) {
                      console.log(data);
                      if (data.status == "successful") {
                          resumeVue.centerDialogVisible = false;
                          resumeVue.toggleSelection();

                          resumeVue.getPositionDeliver();
                          resumeVue.$message({type: 'success', message: "邀请成功!"});
                      } else if (data.status === "warning") {
                          resumeVue.$message.warning(data.errs);
                      }
                      else {
                                console.log(data.status);
                              console.log(data.errs);
                              var error_list=JSON.parse(data.errs);
                              var msg='';
                              for (let key in error_list){
                                  msg=msg+key+error_list[key][0].message+";";
                              }
                              resumeVue.$message.warning(msg);
                          }


                  }
              })
                    }
                    else {
                        console.log('error submit!!');
                        return false;
                     }
                })
            },
                resumeSearch()
                {
                     $.ajax({
                          url:"/api/resumeSearch/",
                          type:"post",
                          headers:{"X-CSRFToken":$.cookie('csrftoken')},
                         data:{'page':this.currentPage,'pageSize':this.pageSize ,'category':resumeVue.category,'keyword':resumeVue.keyword},
                          success:function (data) {
                              var user_list=JSON.parse(data.user_list);
                                      var resume_list=JSON.parse(data.resume_list);
                                      var hunter_list=JSON.parse(data.hunter_list);
                                      resumeVue.flag='positionSearch';
                                      resumeVue.total=data.total;
                                      resumeVue.resume_list=[];
                                      for(let i = 0; i < resume_list.length; i++) {
                                          resumeVue.resume_list.push({
                                              id: resume_list[i].pk,
                                              user_name: hunter_list[i].fields.user_name,
                                              user_email: user_list[i].fields.user_email,
                                              user_phone: user_list[i].fields.user_phone,
                                              {#sex: hunter_list[i].fields.sex,#}
                                              age: resumeVue.getAge(hunter_list[i].fields.birthday),
                                              city: hunter_list[i].fields.city,
                                              Correspondence_address: hunter_list[i].fields.Correspondence_address,
                                              registered_permanent_residence: hunter_list[i].fields.registered_permanent_residence,
                                              education_background: hunter_list[i].fields.education_background,
                                              qq: hunter_list[i].fields.qq,
                                              resume_name: resume_list[i].fields.resume_name,
                                              desired_position: resume_list[i].fields.desired_position,
                                              expected_salary: resume_list[i].fields.expected_salary,
                                              expected_work_city: resume_list[i].fields.expected_work_city,
                                          });
                                          if(hunter_list[i].fields.sex=='0'){
                                                resumeVue.resume_list[i].sex="男";

                                            }
                                            else if(hunter_list[i].fields.sex=='1'){
                                                resumeVue.resume_list[i].sex="女";

                                }

                                      }
                          }
                     })
                },
                resumeCollect()
                {
                    for(let i = 0; i < this.multipleSelection.length; i++)
                    {
                        this.id_list.push(this.multipleSelection[i].id);
                    }
                     $.ajax({
                          url:"/api/resumeCollect/",
                          type:"post",
                          headers:{"X-CSRFToken":$.cookie('csrftoken')},
                         data:{'id_list':JSON.stringify(resumeVue.id_list)},
                          success:function (data) {
                              if(data.status=="successful"){
                                 resumeVue.$message({type: 'success',message: "收藏成功!"});

                              }
                              else if(data.status === "warning"){
                                    resumeVue.$message.warning(data.errs);
                              }
                              resumeVue.toggleSelection()
                          }
                     })
                },


                getAge(strAge) {
                                var birArr = strAge.split("-");
                                var birYear = birArr[0];
                                var birMonth = birArr[1];
                                var birDay = birArr[2];

                                d = new Date();
                                var nowYear = d.getFullYear();
                                var nowMonth = d.getMonth() + 1; //记得加1
                                var nowDay = d.getDate();
                                var returnAge;

                                if (birArr == null) {
                                    return false
                                };
                                var d = new Date(birYear, birMonth - 1, birDay);
                                if (d.getFullYear() == birYear && (d.getMonth() + 1) == birMonth && d.getDate() == birDay) {
                                    if (nowYear == birYear) {
                                        returnAge = 0; //
                                    } else {
                                        var ageDiff = nowYear - birYear; //
                                        if (ageDiff > 0) {
                                            if (nowMonth == birMonth) {
                                                var dayDiff = nowDay - birDay; //
                                                if (dayDiff < 0) {
                                                    returnAge = ageDiff - 1;
                                                } else {
                                                    returnAge = ageDiff;
                                                }
                                            } else {
                                                var monthDiff = nowMonth - birMonth; //
                                                if (monthDiff < 0) {
                                                    returnAge = ageDiff - 1;
                                                } else {
                                                    returnAge = ageDiff;
                                                }
                                            }
                                        } else {
                                            return  "出生日期晚于今天，数据有误"; //返回-1 表示出生日期输入错误 晚于今天
                                        }
                                    }
                                    return returnAge;
                                } else {
                                    return ("输入的日期格式错误！");
                                }
                        },

            },
            delimiters: ['[[', ']]']//Django模板与Vue.js 冲突/ 这句可以指定 {[ ]} 为插值表达式的新符号

        })
        var navVue= new Vue({
            el:'#nav',
            data() {
              return {

                activeIndex2: '4'
              };
            },
            methods: {
              handleSelect(key, keyPath) {
                console.log(key, keyPath);
              }
            },
        })
        var app =new Vue({
	el:'#app',
	data(){
	    return{
            count:0,
            list:[],
            category: [

                    {
                        name: '学历',
                        items: [
                            {
                                name: '专科',
                                active: false
                            },
                            {
                                name: '本科',
                                active: false
                            },
                            {
                                name: '硕士',
                                active: false
                            },
                            {
                                name: '博士',
                                active: false
                            }
                        ]
                    },

                    {
                        name: '性别',
                        items: [
                            {
                                name: '男',
                                active: false
                            },
                            {
                                name: '女',
                                active: false
                            },



                        ]
                    },
                    {
                        name: '地点',
                        items: [
                            {
                                name: '北京',
                                active: false
                            },
                            {
                                name: '上海',
                                active: false
                            },
                            {
                                name: '深圳',
                                active: false
                            },
                            {
                                name: '天津',
                                active: false
                            }
                        ]
                    }
                ],


                condition:[],

        }
    },
	methods:{
		handle:function(index,key){
			console.log(key);
			var tag=true;
			var item=this.category[index].items;
			item.filter(function(v,i){//参数为某个元素、表示元素的位置
				if(i==key){//根据列表的下标找到对应name

					// 有相同的条件name在条件列表中进行删除
					app.condition.filter(function(v2,i){
						if(v.name==v2.name){
						    v.active=false;
							console.log(v.name);
							console.log(i);
							app.condition.splice(i,1);
							console.log(app.condition);
							app.count--;
							tag=false;

						}
					});
					// 没有相同的条件进行添加
					if(tag){
                        v.active=true;
						// target：要更改的数据源(可以是对象或者数组)
						// key：要更改的具体数据
						// value ：重新赋的值
						Vue.set(app.condition,app.count++,v);
console.log(app.condition[app.count-1]);

						tag=true;
					}
				}
			});

		},
		remove:function(index){
			var item=this.category[index].items;
			item.filter(function (v1,key) {
				//将条件状态设置为无效
				v1.active=false;
				//存在相同条件直接在condition删除
				app.condition.filter(function(v2,i){
					if(v1.name==v2.name){
						app.condition.splice(i,1);
						app.count--;
					}
				});
			});
		},
		allIn:function(index){
			var item=this.category[index].items;
			item.filter(function (v,key) {
				v.active=true;
				//存在相同先删除再添加
				app.condition.filter(function(v2,i){
					if(v.name==v2.name){
						app.condition.splice(i,1);
						app.count--;
					}
				});

				//不同直接进行添加
				Vue.set(app.condition,app.count++,v);
			});

		},
         conditionSearch()
                        {
                            this.list=[];
                            for(let i=0;i< 3;i++){

                          for(let j=0;j<this.category[i].items.length;j++)
                          {

                              if(this.category[i].items[j].active==true){

                                  if(this.category[i].name=='学历')
                                  {
                                      this.list.push({'education_background' : this.category[i].items[j].name});
                                  }

                                  else if(this.category[i].name=='性别')
                                  {
                                      this.list.push({'sex' : this.category[i].items[j].name});
                                  }
                                   else if(this.category[i].name=='地点')
                                  {
                                      this.list.push({'city' : this.category[i].items[j].name});
                                  }
                              }
                          }
                        }
                            console.log(this.list);
                           console.log(app.condition);
                            console.log(app.category);
                             $.ajax({
                                  url:"/api/conditionResumeSearch/",
                                  type:"post",
                                 data: {'page':resumeVue.currentPage,'pageSize':resumeVue.pageSize,'condition':JSON.stringify(app.list )},
                                  headers:{"X-CSRFToken":$.cookie('csrftoken')},
                                  success:function (data) {
                                      var user_list=JSON.parse(data.user_list);
                                      var resume_list=JSON.parse(data.resume_list);
                                      var hunter_list=JSON.parse(data.hunter_list);
                                      resumeVue.total=data.total;
                                      resumeVue.flag='conditionSearch';
                                      resumeVue.resume_list=[];
                                      for(let i = 0; i < resume_list.length; i++) {
                                          resumeVue.resume_list.push({
                                              id:resume_list[i].pk,
                                              user_name:hunter_list[i].fields.user_name,
                                              user_email:user_list[i].fields.user_email,
                                              user_phone:user_list[i].fields.user_phone,
                                              {#sex:hunter_list[i].fields.sex,#}
                                              age:resumeVue.getAge(hunter_list[i].fields.birthday),
                                              city:hunter_list[i].fields.city,
                                              Correspondence_address:hunter_list[i].fields.Correspondence_address,
                                              registered_permanent_residence:hunter_list[i].fields.registered_permanent_residence,
                                              education_background:hunter_list[i].fields.education_background,
                                              qq:hunter_list[i].fields.qq,
                                              resume_name:resume_list[i].fields.resume_name,
                                              desired_position:resume_list[i].fields.desired_position,
                                              expected_salary:resume_list[i].fields.expected_salary,
                                              expected_work_city:resume_list[i].fields.expected_work_city,
                                          });
                                          if(hunter_list[i].fields.sex=='0'){
                                                resumeVue.resume_list[i].sex="男";

                                            }
                                            else if(hunter_list[i].fields.sex=='1'){
                                                resumeVue.resume_list[i].sex="女";

                                }

                                      };
                                  }
                             })
                        },
	}
            ,
            delimiters: ['[[', ']]']//Django模板与Vue.js 冲突/ 这句可以指定 {[ ]} 为插值表达式的新符号


});
    </script>
</body>
</html>